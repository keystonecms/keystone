{% extends "@pages/admin/layout.twig" %}

{% block title %}Media â€“ Keystone{% endblock %}

{% block header %}
    <h2>Media</h2>
{% endblock %}

{% block content %}

<form method="post"
      action="/admin/media/upload"
      enctype="multipart/form-data"
      style="margin-bottom:2rem">
     
      {{ csrf() }}

    <input type="file" name="file" required>
    <button type="submit">Upload</button>
</form>

<table>
    <thead>
        <tr>
            <th>Preview</th>
            <th>Filename</th>
            <th>Type</th>
            <th>Size</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
    {% for item in media %}
        <tr>
            <td>
                {% if item.mime_type starts with 'image/' %}
                    <img src="{{ item.path }}" style="max-width:60px">
                {% endif %}
            </td>
            <td>{{ item.filename }}</td>
            <td>{{ item.mime_type }}</td>
            <td>{{ (item.size / 1024)|round }} KB</td>
            <td><button type="button"
        class="btn btn-sm btn-primary"
        onclick="useMedia('{{ item.path }}')">
    Use
</button></td>
            <td>


                
<form method="post"
      action="/admin/media/{{ item.id }}/delete"
      onsubmit="return confirm('Delete this media?')">
    {{ csrf() }}
   <button class="danger" type="submit">Delete</button>
</form>
</td>

        </tr>
    {% endfor %}
    </tbody>
</table>

{% if picker %}
<script>
    function useMedia(url) {
        if (window.opener && window.opener.insertImage) {
            window.opener.insertImage(url);
            window.close();
        }
    }
</script>
{% endif %}

{% endblock %}


